
    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Line Length Comparison: TSO vs PyPSA</title>
        <script src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>
        <style>
            body {
                font-family: Arial, sans-serif;
                margin: 20px;
                background-color: #f9f9f9;
            }
            .chart-container {
                background-color: white;
                border-radius: 5px;
                box-shadow: 0 2px 5px rgba(0,0,0,0.1);
                padding: 20px;
                margin-bottom: 30px;
            }
            h2 {
                color: #333;
                border-bottom: 1px solid #ddd;
                padding-bottom: 10px;
                margin-top: 0;
            }
            .note {
                font-size: 0.9em;
                font-style: italic;
                color: #666;
                margin-top: 5px;
            }
            .summary-table {
                width: 100%;
                border-collapse: collapse;
                margin-bottom: 20px;
            }
            .summary-table th, .summary-table td {
                border: 1px solid #ddd;
                padding: 8px;
                text-align: right;
            }
            .summary-table th:first-child, .summary-table td:first-child {
                text-align: left;
            }
            .summary-table th {
                background-color: #f2f2f2;
            }
            .summary-table tr:nth-child(even) {
                background-color: #f9f9f9;
            }
            #barChart {
                height: 500px;
                width: 100%;
            }
            .pie-chart {
                height: 400px;
                width: 100%;
            }
            .error-message {
                color: red;
                font-weight: bold;
                padding: 20px;
                text-align: center;
            }
        </style>
    </head>
    <body>
        <div class="chart-container">
            <h2>Summary of Line Lengths: TSO vs PyPSA</h2>
            <div class='note'>Note: 380kV lines in PyPSA data are shown as 400kV for comparison.</div>
            
    <table class="summary-table">
        <thead>
            <tr>
                <th>Voltage Level</th>
                <th>TSO Length</th>
                <th>TSO %</th>
                <th>PyPSA Length</th>
                <th>PyPSA %</th>
                <th>Difference</th>
            </tr>
        </thead>
        <tbody>
            
    <tr>
        <td><strong>TOTAL</strong></td>
        <td>21147.11 km</td>
        <td>100%</td>
        <td>21385.75 km</td>
        <td>100%</td>
        <td>1.13%</td>
    </tr>
    
            <tr>
                <td>220 kV</td>
                <td>6450.99 km</td>
                <td>30.51%</td>
                <td>6901.77 km</td>
                <td>32.27%</td>
                <td>6.99%</td>
            </tr>
            
            <tr>
                <td>400 kV</td>
                <td>14696.12 km</td>
                <td>69.49%</td>
                <td>14317.40 km</td>
                <td>66.95%</td>
                <td>-2.58%</td>
            </tr>
            
        </tbody>
    </table>
    
        </div>

        <div class="chart-container">
            <h2>Line Length Comparison by Voltage Level</h2>
            <div id="barChart"></div>
        </div>

        <div class="chart-container">
            <h2>Line Length Distribution Comparison</h2>
            <div id="pieCharts" style="display: flex; flex-wrap: wrap;">
                <div id="jaoPieChart" class="pie-chart" style="width: 50%;"></div>
                <div id="pypsaPieChart" class="pie-chart" style="width: 50%;"></div>
            </div>
        </div>

        <script>
            // Check if Plotly is loaded
            if (typeof Plotly === 'undefined') {
                document.body.innerHTML += '<div class="error-message">Error: Plotly library failed to load. Please check your internet connection or try a different browser.</div>';
            }

            // Data for charts
            const data = [{"voltage": "220", "jao_length_km": 6450.986324621828, "jao_percentage": 30.505286498913026, "pypsa_length_km": 6901.765508480676, "pypsa_percentage": 32.27272885011468, "difference_percentage": 6.987755998463895}, {"voltage": "400", "jao_length_km": 14696.123127543751, "jao_percentage": 69.49471350108696, "pypsa_length_km": 14317.400301182217, "pypsa_percentage": 66.94831593319664, "difference_percentage": -2.5770254037387916}];

            // Check if data is available and log for debugging
            console.log("Chart data:", data);

            try {
                // Bar chart for comparison
                if (data && data.length > 0) {
                    const barChartData = [
                        {
                            x: data.map(d => d.voltage + ' kV'),
                            y: data.map(d => d.jao_length_km),
                            name: 'TSO',
                            type: 'bar',
                            marker: { color: 'rgba(58, 71, 80, 0.6)' }
                        },
                        {
                            x: data.map(d => d.voltage + ' kV'),
                            y: data.map(d => d.pypsa_length_km),
                            name: 'PyPSA',
                            type: 'bar',
                            marker: { color: 'rgba(246, 78, 139, 0.6)' }
                        }
                    ];

                    const barChartLayout = {
                        title: 'Line Length by Voltage Level',
                        barmode: 'group',
                        yaxis: {
                            title: 'Length (km)'
                        },
                        legend: {
                            x: 0.1,
                            y: 1.1,
                            orientation: 'h'
                        },
                        annotations: [
                            {
                                x: 0.5,
                                y: -0.15,
                                showarrow: false,
                                text: `Total TSO: 21147.11 km | Total PyPSA: 21385.75 km | Difference: -2.58%`,
                                xref: 'paper',
                                yref: 'paper',
                                font: { size: 12 }
                            }
                        ],
                        height: 500,
                        autosize: true
                    };

                    Plotly.newPlot('barChart', barChartData, barChartLayout);

                    // Pie charts for distribution
                    const jaoPieData = [
                        {
                            labels: data.map(d => d.voltage + ' kV'),
                            values: data.map(d => d.jao_length_km),
                            type: 'pie',
                            textinfo: 'label+percent',
                            hoverinfo: 'label+value+percent',
                            marker: {
                                colors: ['rgba(58, 71, 80, 0.8)', 'rgba(58, 71, 80, 0.5)']
                            }
                        }
                    ];

                    const jaoPieLayout = {
                        title: 'TSO Line Length Distribution',
                        showlegend: false,
                        height: 400,
                        autosize: true,
                        margin: { t: 50, b: 20, l: 20, r: 20 },
                        annotations: [
                            {
                                x: 0.5,
                                y: -0.1,
                                showarrow: false,
                                text: `Total: 21147.11 km`,
                                xref: 'paper',
                                yref: 'paper',
                                font: { size: 12 }
                            }
                        ]
                    };

                    const pypsaPieData = [
                        {
                            labels: data.map(d => d.voltage + ' kV'),
                            values: data.map(d => d.pypsa_length_km),
                            type: 'pie',
                            textinfo: 'label+percent',
                            hoverinfo: 'label+value+percent',
                            marker: {
                                colors: ['rgba(246, 78, 139, 0.8)', 'rgba(246, 78, 139, 0.5)']
                            }
                        }
                    ];

                    const pypsaPieLayout = {
                        title: 'PyPSA Line Length Distribution',
                        showlegend: false,
                        height: 400,
                        autosize: true,
                        margin: { t: 50, b: 20, l: 20, r: 20 },
                        annotations: [
                            {
                                x: 0.5,
                                y: -0.1,
                                showarrow: false,
                                text: `Total: 21385.75 km`,
                                xref: 'paper',
                                yref: 'paper',
                                font: { size: 12 }
                            }
                        ]
                    };

                    Plotly.newPlot('jaoPieChart', jaoPieData, jaoPieLayout);
                    Plotly.newPlot('pypsaPieChart', pypsaPieData, pypsaPieLayout);
                } else {
                    document.getElementById('barChart').innerHTML = '<div class="error-message">No data available for charts</div>';
                    document.getElementById('jaoPieChart').innerHTML = '<div class="error-message">No data available for charts</div>';
                    document.getElementById('pypsaPieChart').innerHTML = '<div class="error-message">No data available for charts</div>';
                }
            } catch (e) {
                console.error("Error rendering charts:", e);
                document.getElementById('barChart').innerHTML = '<div class="error-message">Error rendering chart: ' + e.message + '</div>';
                document.getElementById('jaoPieChart').innerHTML = '<div class="error-message">Error rendering chart: ' + e.message + '</div>';
                document.getElementById('pypsaPieChart').innerHTML = '<div class="error-message">Error rendering chart: ' + e.message + '</div>';
            }
        </script>
    </body>
    </html>
    